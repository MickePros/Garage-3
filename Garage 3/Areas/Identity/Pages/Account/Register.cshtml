[HttpPost]
[ValidateAntiForgeryToken]
public async Task<IActionResult>
    Register(RegisterViewModel model, string returnUrl = null)
    {
    if (ModelState.IsValid)
    {
    var user = new ApplicationUser { UserName = model.UserName, Email = model.Email };

    // Skapa användare i systemet
    var result = await _userManager.CreateAsync(user, model.Password);
    if (result.Succeeded)
    {
    // Logga in användaren
    await _signInManager.SignInAsync(user, isPersistent: false);
    return LocalRedirect(returnUrl ?? Url.Action("Index", "Home")); // Skicka med ReturnUrl
    }

    foreach (var error in result.Errors)
    {
    ModelState.AddModelError(string.Empty, error.Description);
    }
    }

    // Returnera till registreringsvyn om det är några fel
    return View(model);
    }
